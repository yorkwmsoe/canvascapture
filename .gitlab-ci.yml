stages:
  - 🐋 docker
  - 🛞 install
  - 🤞 test
  - 📦 build
  - 🚀 release

variables:
  CLI_BASE_PATH: apps/cli
  DESKTOP_BASE_PATH: apps/desktop

include:
  - local: /apps/cli/.gitlab-ci.yml
  - local: /apps/desktop/.gitlab-ci.yml

build-docker-desktop:
  stage: 🐋 docker
  image: docker:stable
  services:
    - docker:dind
  script:
    - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY
    - docker build . -f $DESKTOP_BASE_PATH/Dockerfile -t $CI_REGISTRY_IMAGE/desktop
    - docker push $CI_REGISTRY_IMAGE/desktop
